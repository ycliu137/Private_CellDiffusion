# Configuration file for collapse diagnostic pipeline
# Tests different network depths for CellDiffusion and GCN integration methods

datasets: ["Endom314K_GSM4577312_GSM6574543", 
            "Endom314K_GSM6605435_GSM6605432",
            "Endom314K_GSM6605435_GSM6605434",
            "Endom314K_GSM6605436_GSM6605440",
            "Endom314K_GSM6605437_GSM6605434"]

normalized_data: True
# Data paths
data:
  input_path: "../data/inputs/integration/"
  # Output directory (relative to project root, or use absolute path)
  output_dir: "../data/outputs/PL_collapse_diag"

# Preprocessing parameters
preprocess:
  min_cells: 3
  target_sum: 10000
  n_top_genes: 2000
  min_mean: 0.0125
  max_mean: 9
  min_disp: 0.5

# Feature encoder parameters
feature_encoder:
  D_encode_list: [2000, 300, 50]
  D_decode_list: [50, 300, 2000]
  max_epoch: 2000
  lr: 0.001

# Integration graph parameters
integration_graph:
  n_edges_per_node: 50
  k_mnn: 50

# Integration loss adjacency parameters
integration_loss_adj:
  k: 50

# Network layers to test for both CellDiffusion and GCN
integration_network_layers: [2, 4, 6, 8, 10, 12, 14, 16]

# Integration diffusion parameters (CellDiffusion)
integration_diffusion:
  max_epoch: 2000
  lr: 0.001
  num_features_diffusion: 50
  num_heads_diffusion: 8
  # time_increment_diffusion must have the same length as integration_network_layers
  # Values are paired by index (not all combinations):
  #   num_steps=2  -> time_increment=0.5
  #   num_steps=4  -> time_increment=0.4
  #   num_steps=6  -> time_increment=0.3
  #   num_steps=8  -> time_increment=0.2
  #   num_steps=10 -> time_increment=0.17
  #   num_steps=12 -> time_increment=0.15
  #   num_steps=14 -> time_increment=0.12
  #   num_steps=16 -> time_increment=0.1
  time_increment_diffusion: [0.5, 0.4, 0.3, 0.2, 0.17, 0.15, 0.12, 0.1]

# Integration GCN parameters
integration_gcn:
  max_epoch: 2000
  lr: 0.001
  num_features_gcn: 50
  dropout: 0.0

# Evaluation parameters
evaluation:
  label_key: "labels"
  batch_key: "batch"
  k: 50  # k for KNN in evaluate_knn_neighbor_purity

# UMAP visualization parameters
umap:
  n_neighbors: 50
  n_pcs: 50

# Device
device: "cuda"  # or "cpu"

# SCIB evaluation parameters
scib_evaluation:
  n_jobs: 1  # Number of parallel jobs for scib benchmark (1 is recommended for stability)

